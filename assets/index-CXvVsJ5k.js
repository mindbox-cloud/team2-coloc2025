(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();function S(o,e,a,t){const r=[{xStart:0,yStart:0},{xStart:t-1,yStart:0},{xStart:0,yStart:t-1},{xStart:t-1,yStart:t-1}][e];let l=0;for(let m=0;m<t&&l<o.size;m++)for(let c=0;c<t&&l<o.size;c++){const u=r.xStart+(e%2===0?m:-m),p=r.yStart+(e<2?c:-c);u>=0&&u<t&&p>=0&&p<t&&!a[p][u]&&(a[p][u]={army:o,currentHp:o.hp},l++)}}function F(o){const{fieldSize:e,armies:a}=o,t=Array.from({length:e},()=>Array.from({length:e},()=>null));return a.forEach((n,r)=>{S(n,r,t,e)}),{state:t,makeTurn(){console.log("сделали шаг")}}}const A=[{id:"size",label:"Размер армии:",min:1,max:100,default:10},{id:"hp",label:"Здоровье солдата:",min:1,max:100,default:10},{id:"strength",label:"Сила удара:",min:1,max:10,default:1},{id:"visionLength",label:"Дальность обзора:",min:1,max:10,default:3},{id:"criticalPercent",label:"Шанс критического удара:",min:0,max:100,default:10}];function O(o){const e=document.createElement("form"),a=[];e.classList.add("p-3");const t=document.createElement("div");t.classList.add("mb-3");const n=document.createElement("label");n.textContent="Размер поля (N):",n.classList.add("form-label");const r=document.createElement("input");r.type="number",r.classList.add("form-control"),r.required=!0,r.min="1",r.max="100",r.value="10",t.append(n,r);const l=document.createElement("div");l.classList.add("mb-3");const m=document.createElement("label");m.textContent="Интервал (мс):",m.classList.add("form-label");const c=document.createElement("input");c.type="number",c.classList.add("form-control"),c.required=!0,c.min="1",c.value="1000",l.append(m,c);const u=()=>{const s=document.createElement("button");return s.type="submit",s.textContent="Запустить",s.classList.add("btn","btn-primary"),s},p=()=>{const s=document.createElement("button");return s.type="button",s.textContent="Добавить армию",s.classList.add("btn","btn-secondary"),s.addEventListener("click",()=>{const g=a.length;if(g<=3){const f=document.createElement("div");f.classList.add("card","mb-3","p-3");const h=document.createElement("h5");h.textContent=`Армия #${g+1}`,h.classList.add("card-title","mb-3"),f.appendChild(h);const b={color:"#9c4f4f"};A.forEach(i=>{const x=document.createElement("div");x.classList.add("mb-3");const E=document.createElement("label");E.textContent=i.label,E.classList.add("form-label"),E.htmlFor=`army-${g}-${i.id}`;const d=document.createElement("input");d.type="number",d.id=`army-${g}-${i.id}`,d.classList.add("form-control"),d.required=!0,d.min=i.min.toString(),d.max=i.max.toString(),d.value=i.default.toString(),d.addEventListener("change",()=>{b[i.id]=Number(d.value)}),b[i.id]=i.default,x.append(E,d),f.appendChild(x)});const y=document.createElement("input");y.type="color",y.value=b.color;const L=document.createElement("label");L.textContent="Цвет армии:",L.classList.add("form-label"),y.addEventListener("change",()=>{b.color=y.value}),f.appendChild(L),f.appendChild(y),a.push(b),e.insertBefore(f,v)}else alert("Максимальное количество армий - 4")}),s},v=document.createElement("div");return v.append(p(),u()),v.classList.add("btn-group","gap-2"),e.append(t,l,v),e.addEventListener("submit",s=>{console.log(a),s.preventDefault(),a.length>1?o({fieldSize:Number(r.value),intervalMs:Number(c.value),armies:a}):alert("Армий должно быть больше одной")}),e}const P="game-field";function M(o){const e=document.createElement("div");e.classList.add("field-root"),e.style.setProperty("--n",o.toString()),e.id=P;for(let a=0;a<o;a++)for(let t=0;t<o;t++){const n=document.createElement("div");n.classList.add("field-cell"),e.append(n)}return e}function w(o,e){const a=document.getElementById(P);if(a&&a.style.getPropertyValue("--n")===o.toString())return a;a==null||a.remove();const t=M(o);return e.append(t),t}function I(o,e){const a=w(o.length,e);for(let t=0;t<o.length;t++)for(let n=0;n<o[t].length;n++){const r=a.children[t*o.length+n],l=o[t][n];r.style.backgroundColor=l?l.army.color:"white"}}const C=document.getElementById("app");let N;const B=O(o=>{clearInterval(N);const e=F(o);I(e.state,C),N=setInterval(()=>{e.makeTurn(),I(e.state,C)},o.intervalMs)});C.append(B);
